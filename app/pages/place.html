<div class="row">
    <div class="col-lg-12">
        <h1>{{::place.title}}</h1>
        <span class="text-muted"><span class="glyphicon glyphicon-map-marker"></span>&nbsp;{{::place.country}}, {{::place.state}}, {{::place.city}}, {{::place.address}} - {{::place.zip}}</span>
        <hr>
    </div>
    <!-- /.col-lg-12 -->
</div>
<div class="btn-group" role="group" data-ng-if="availableYears.length>0">
    <button data-ng-class="{'active':year==currentYear}" data-ng-repeat="year in availableYears" type="button" class="btn btn-default" data-ng-click="selectYear(year)">{{::year}}</button>
</div>
<table class="table table-hover table-condensed year-bills">
    <thead>
    <tr>
        <th colspan="2">Month</th>
        <th ng-repeat="service in services">{{::service.title}}</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="monthBillsServices in monthlyGroupedBills">
        <td>{{::monthBillsServices.key}}</td>
        <td><a href="" data-ng-click="addBillsForMonth(monthBillsServices.month)" class="add-bills"><i class="glyphicon glyphicon-plus-sign"></i></a></td>
        <td ng-repeat="billsForService in monthBillsServices.value">
            <table style="width:100%">
                <tr ng-repeat="bill in billsForService">
                    <td style="width:6em">
                        {{::bill.readout}}
                    </td>
                    <td>
                        <span class="label" data-ng-class="{true:'label-success', false:'label-danger' }[!!bill.paid]">{{::bill.value.amount}}&nbsp;{{::bill.value.currency}}</span>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    </tbody>
</table>


<div class="modal fade" tabindex="-1" role="dialog" id="addBillsForMonthModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Add Bills for {{ monthLabel(addBillsForMonthData.month, currentYear ) }}</h4>
            </div>
            <div class="modal-body">
                <table class="table table-responsive">
                    <thead>
                    <tr>
                        <td>Service</td>
                        <td>Readout</td>
                        <td>Amount to Pay</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr data-ng-repeat="service in addBillsForMonthData.services">
                        <td style="vertical-align: middle">
                            {{::service.title}}
                        </td>
                        <td>
                            <div data-ng-if="service.serviceRate.rateData.ProgressiveRateData">
                                <input class="form-control" type="number" placeholder="Readout" ng-disabled="service.payed" data-ng-model="service.readout">
                                <small data-ng-if="service.lastPayedBill" >Latest readout: {{service.lastPayedBill.readout}}</small>
                            </div>
                        </td>
                        <td>
                            <div data-ng-if="service.serviceRate.rateData.ManualPriceRateData || service.serviceRate.rateData.FixedPriceRateData">
                                <input class="form-control" type="number" placeholder="Amount" ng-disabled="service.payed" data-ng-model="service.value.amount">
                            </div>
                            <div data-ng-if="service.serviceRate.rateData.ProgressiveRateData">
                                <input class="form-control" readonly="readonly" value="Auto Calculated">
                            </div>


                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-ng-click="saveBills(addBillsForMonthData.services)">Save changes</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->